// data for city marker sets

USCities = [
	{name: "Anchorage, AK",     lat: 61.217, lng: -149.90,  zone:  -9},
	{name: "Atlanta, GA",       lat: 33.733, lng: -84.383,  zone:  -5},
	{name: "Bismarck, ND",      lat: 46.817, lng: -100.783, zone:  -6},
	{name: "Boston, MA",        lat: 42.35,  lng: -71.05,   zone:  -5},
	{name: "Chicago, IL",       lat: 41.85,  lng: -87.65,   zone:  -6},
	{name: "Dallas, TX",        lat: 32.78,  lng: -96.80,   zone:  -6},
	{name: "Denver, CO",        lat: 39.74,  lng: -104.99,  zone:  -7},
	{name: "Detroit, MI",       lat: 42.333, lng: -83.05,   zone:  -5},
	{name: "Honolulu, HI",      lat: 21.30,  lng: -157.85,  zone: -10},
	{name: "Los Angeles, CA",   lat: 34.05,  lng: -118.23,  zone:  -8},
	{name: "Omaha, NE",         lat: 41.26,  lng: -95.95,   zone:  -6},
	{name: "Miami, FL",         lat: 25.77,  lng: -80.18,   zone:  -5},
	{name: "Minneapolis, MN",   lat: 44.97,  lng: -93.25,   zone:  -6},
	{name: "New Orleans, LA",   lat: 29.95,  lng: -90.07,   zone:  -6},
	{name: "New York City, NY", lat: 40.72,  lng: -74.02,   zone:  -5},
	{name: "Phoenix, AZ",       lat: 33.43,  lng: -112.07,  zone:  -7},
	{name: "Portland, OR",      lat: 45.52,  lng: -122.65,  zone:  -8},
	{name: "Raleigh, NC",       lat: 35.78,  lng: -78.65,   zone:  -5},
	{name: "Saint Louis, MO",   lat: 38.62,  lng: -90.18,   zone:  -6},
	{name: "Salt Lake City, UT",lat: 40.77,  lng: -111.89,   zone: -7},
	{name: "San Francisco, CA", lat: 37.77,  lng: -122.42,  zone:  -8},
	{name: "Seattle, WA",       lat: 47.60,  lng: -122.32,  zone:  -8},
	{name: "Washington DC",     lat: 38.88,  lng: -77.03,   zone:  -5},
];



var WorldCities = [
	{name: "Adelaide, SA, Australia",    lat: -34.925, lng: 138.60,   zone:  9.5},
	{name: "Addis Ababa, Ethiopia",      lat: 9.01,    lng: 38.758,   zone:  3},
	{name: "Astana, Kazakhstan",         lat: 51.183,  lng:  71.45,   zone:  6},
	{name: "Auckland, New Zealand",      lat: -36.847, lng: 174.77,   zone: 12},
	{name: "Baku, Azerbaijan",           lat: 40.417,  lng: 49.825,   zone:  4},
	{name: "Bangkok, Thailand",          lat: 13.725,  lng: 100.475,  zone:  7},
	{name: "Beijing, China",             lat: 39.92,   lng: 116.42,   zone:  8},
	{name: "Berlin, Germany",            lat: 52.33,   lng: 13.30,    zone:  1},
	{name: "Bombay, India",              lat: 18.93,   lng: 72.83,    zone:  5.5},
	{name: "Buenos Aires, Argentina",    lat: -34.60,  lng: -58.45,   zone: -3},
	{name: "Cairo, Egypt",               lat: 30.10,   lng: 31.37,    zone:  2},
	{name: "Caracas, Venezuela",         lat: 10.5,    lng: -66.898,  zone: -4.5},
	{name: "Cape Town, South Africa",    lat: -33.92,  lng: 18.37,    zone:  2},
	{name: "Dakar, Senegal",             lat: 14.687,  lng: -17.45,   zone:  0},
	{name: "Darwin, NT, Australia",      lat: -12.46,  lng: 130.842,  zone:  9.5},
	{name: "Edmonton, AB, Canada",       lat: 53.533,  lng: -113.494, zone: -7},
	{name: "Halifax, NS, Canada",        lat: 44.646,  lng: -63.575,  zone: -4},
	{name: "Havana, Cuba",               lat: 23.133,  lng: -82.367,  zone: -5},
	{name: "Helsinki, Finland",          lat: 60.17,   lng: 24.97,    zone:  2},
	{name: "Hong Kong, China",           lat: 22.25,   lng: 114.17,   zone:  8},
	{name: "Jerusalem, Israel",          lat: 31.78,   lng: 35.23,    zone:  2},
	{name: "Johannesburg, South Africa", lat: -26.20,  lng: 28.046,   zone:  2},
	{name: "Kabul, Afghanistan",         lat: 34.53,   lng: 69.172,   zone:  4.5},
	{name: "Karachi, Pakistan",          lat: 24.892,  lng: 67.027,   zone:  5},
	{name: "Kathmandu, Nepal",           lat: 27.70,   lng: 85.317,   zone:  5.75},
	{name: "Lagos, Nigeria",             lat: 6.442,   lng: 3.417,    zone:  1},
	{name: "Lima, Peru",                 lat: -12.092, lng: -77.047,  zone: -5},
	{name: "Lisbon, Portugal",           lat: 38.707,  lng: -9.133,   zone:  0},
	{name: "London, United Kingdom",     lat: 51.50,   lng: -0.13,    zone:  0},
	{name: "Manaus, Brazil",             lat: -3.107,  lng: -60.025,  zone: -4},
	{name: "Mexico City, Mexico",        lat: 19.4,    lng: -99.15,   zone: -6},
	{name: "Montreal, QC, Canada",       lat: 45.55,   lng: -73.633,  zone: -5},
	{name: "Moscow, Russia",             lat: 55.75,   lng: 37.58,    zone:  3},
	{name: "New Delhi, India",           lat: 28.6,    lng: 77.2,     zone:  5.5},
	{name: "Nuku alofa, Tonga",          lat: -21.133, lng: -175.217, zone: 13},
	{name: "Nuuk, Greenland",            lat: 64.183,  lng: -51.717,  zone: -3},
	{name: "Ottawa, Canada",             lat: 45.42,   lng: -75.7,    zone: -5},
	{name: "Paris, France",              lat: 48.87,   lng: 2.67,     zone:  1},
	{name: "Perth, WA, Australia",       lat: -31.955, lng: 115.858,  zone:  8},
	{name: "Reykjavik, Iceland",         lat: 64.133,  lng: -21.9,    zone:  0},
	{name: "Rio de Janeiro, Brazil",     lat: -22.90,  lng: -43.23,   zone: -3},
	{name: "Riyadh, Saudi Arabia",       lat: 24.63,   lng: 46.72,    zone:  3},
	{name: "Rome, Italy",                lat: 41.90,   lng: 12.48,    zone:  1},
	{name: "Santiago, Chile",            lat: -33.425, lng: -70.567,  zone: -4},
	{name: "Solomon Islands",            lat: -9.646,  lng: 160.375,  zone: 11},
	{name: "Stockholm, Sweden",          lat: 59.333,  lng: 18.067,   zone:  1},
	{name: "Sydney, Australia",          lat: -33.87,  lng: 151.22,   zone: 10},
	{name: "Tehran, Iran",               lat: 35.70,   lng: 51.42,    zone:  3.5},
	{name: "Tokyo, Japan",               lat: 35.70,   lng: 139.77,   zone:  9},
	{name: "Vancouver, BC, Canada",      lat: 49.267,  lng: -123.117, zone: -8},
	{name: "Vladivostok, Russia",        lat: 43.131,  lng: 131.925,  zone: 10},
	{name: "Winnipeg, MB, Canada",       lat: 49.896,  lng: -97.15,   zone: -6},
	{name: "Yangon, Myanmar",            lat: 16.783,  lng: 96.158,   zone:  6.5},
	{name: "Zurich, Switzerland",        lat: 47.38,   lng: 8.53,     zone:  1},
];

var obs = [
	{name: "Barrow, AK",             lat: 71.323,  lng: -156.611,  zone:  -9},
//	{name: "Trinidad Head, CA",      lat: 41.054,  lng: -124.1508,  zone:  -8},
	{name: "Mauna Loa, HI",          lat: 19.536,  lng: -155.576,  zone: -10},
	{name: "American Samoa",         lat: -14.2474, lng: -170.5646,  zone: -11},
	{name: "South Pole, Antarctica", lat: -89.98, lng: -24.80,   zone: -12},
//	{name: "Summit, Greenland",      lat: 72.5804, lng: -38.4559, zone:  -3}
];

var surfrad = [
	{name: 'Goodwin Creek, MS',  lat: 34.254, lng: -89.874,  zone: -6},
	{name: 'Fort Peck, MT',      lat: 48.311, lng: -105.103, zone: -7},
	{name: 'Bondville, IL',      lat: 40.055, lng: -88.372,  zone: -6},
	{name: 'Table Mountain, CO', lat: 40.125, lng: -105.237, zone: -7},
	{name: 'Desert Rock, NV',    lat: 36.626, lng: -116.018, zone: -8},
	{name: 'Penn State, PA',     lat: 40.72,  lng: -77.93,   zone: -5},
	{name: 'Sioux Falls, SD',    lat: 43.733, lng: -96.6233, zone: -6},
        {name: 'Albuquerque, NM',    lat: 35.038,  lng: -106.6221, zone: -7},
        {name: 'Bismark, ND',        lat: 46.7718, lng: -100.7596, zone: -6},
        {name: 'Hanford, CA',        lat: 36.3136, lng: -119.6316, zone: -8},
        {name: 'Madison, WI',        lat: 43.0725, lng: -89.4113,  zone: -6},
        {name: 'Oak Ridge, TN',      lat: 35.9610, lng: -84.2884,  zone: -5},
        {name: 'Salt Lake City, UT', lat: 40.7722, lng: -111.9550, zone: -7},
        {name: 'Seattle, WA',        lat: 47.6869, lng: -122.2567, zone: -8},
        {name: 'Sterling, VA',       lat: 38.9720, lng: -77.4870,  zone: -5},
        {name: 'Tallahassee, FL',    lat: 30.3968, lng: -84.3296,  zone: -5},

];

var sites = [
{name: 'Albuquerque, New Mexico, United States',                                       lat:    35.0380,   lng:  -106.6221,  zone:  -7.0},
{name: 'Alaska Coast Guard, United States',                                            lat:    65.0000,   lng:  -165.0000,  zone:  -8.0},
{name: 'Alert, Nunavut, Canada',                                                       lat:    82.4508,   lng:   -62.5072,  zone:  -4.0},
{name: 'Argyle, Maine, United States',                                                 lat:    45.0345,   lng:   -68.6821,  zone:  -5.0},
{name: 'Anmyeon-do, Republic of Korea',                                                lat:    36.5389,   lng:   126.3295,  zone:   9.0},
{name: 'Appalachian State, United States',                                             lat:    36.2000,   lng:   -81.7000,  zone:  -5.0},
{name: 'Arrival Heights, Antarctica, New Zealand',                                     lat:   -77.8330,   lng:   166.2000,  zone: -11.0},
{name: 'El Arenosillo, Spain',                                                         lat:    37.1000,   lng:    -6.7333,  zone:  -1.0},
{name: 'Ascension Island, United Kingdom',                                             lat:    -7.9667,   lng:   -14.4000,  zone:  -1.0},
{name: 'Assekrem, Algeria',                                                            lat:    23.2625,   lng:     5.6322,  zone:   1.0},
{name: 'Terceira Island, Azores, Portugal',                                            lat:    38.7660,   lng:   -27.3750,  zone:  -1.0},
{name: 'Beo-Moussala, Bulgaria',                                                       lat:    42.1792,   lng:    23.5856,  zone:   3.0},
{name: 'Prospect Hill, Bermuda, United Kingdom',                                       lat:    32.3008,   lng:   -64.7660,  zone:  -4.0},
{name: 'Baring Head Station, New Zealand',                                             lat:   -41.4083,   lng:   174.8710,  zone:  12.0},
{name: 'Bismarck, North Dakota, United States',                                        lat:    46.7718,   lng:  -100.7596,  zone:  -6.0},
{name: 'Bukit Kototabang, Indonesia',                                                  lat:    -0.2020,   lng:   100.3180,  zone:   7.0},
{name: 'Boulder, Colorado, United States',                                             lat:    39.9910,   lng:  -105.2607,  zone:  -7.0},
{name: 'Tudor Hill, Bermuda, United Kingdom',                                          lat:    32.2647,   lng:   -64.8788,  zone:  -4.0},
{name: 'Nashville, Tennessee, United States',                                          lat:    36.2468,   lng:   -86.5620,  zone:  -6.0},
{name: 'Bondville, Illinois, United States',                                           lat:    40.0519,   lng:   -88.3731,  zone:  -6.0},
{name: 'Barrow, Alaska, United States',                                                lat:    71.3230,   lng:  -156.6114,  zone:  -9.0},
{name: 'Briggsdale, Colorado, United States',                                          lat:    40.6347,   lng:  -104.3269,  zone:  -7.0},
{name: 'Cold Bay, Alaska, United States',                                              lat:    55.2100,   lng:  -162.7200,  zone:  -9.0},
{name: 'Caribou, Maine, United States',                                                lat:    46.8680,   lng:   -68.0130,  zone:  -5.0},
{name: 'Cape Grim, Tasmania, Australia',                                               lat:   -40.6830,   lng:   144.6900,  zone:  10.0},
{name: 'Christmas Island, Republic of Kiribati',                                       lat:     1.7000,   lng:  -157.1518,  zone: -10.0},
{name: 'Centro de Investigacion de la Baja Atmosfera (CIBA), Spain',                   lat:    41.8100,   lng:    -4.9300,  zone:   1.0},
{name: 'Cape May, New Jersey, United States',                                          lat:    38.8300,   lng:   -74.3200,  zone:  -5.0},
{name: 'Cape San Juan, Puerto Rico, USA',                                              lat:    18.3811,   lng:   -65.6177,  zone:  -4.0},
{name: 'Cape Point, South Africa',                                                     lat:   -34.3523,   lng:    18.4891,  zone:   2.0},
{name: 'Carbon in Arctic Reservoirs Vulnerability Experiment (CARVE), United States',  lat:    64.9863,   lng:  -147.5980,  zone:  -8.0},
{name: 'Crozet Island, France',                                                        lat:   -46.4337,   lng:    51.8478,  zone:   5.0},
{name: 'Desert Rock, Nevada, United States',                                           lat:    36.6237,   lng:  -116.0195,  zone:  -8.0},
{name: 'Drake Passage, N/A',                                                           lat:   -59.0000,   lng:   -64.6900,  zone:  -4.0},
{name: 'Dongsha Island, Taiwan',                                                       lat:    20.6992,   lng:   116.7297,  zone:   8.0},
{name: 'Egbert, Ontario, Canada',                                                      lat:    44.2310,   lng:   -79.7832,  zone:  -4.0},
{name: 'Easter Island, Chile',                                                         lat:   -27.1597,   lng:  -109.4284,  zone:  -7.0},
{name: 'Estevan Point,  British Columbia, Canada',                                     lat:    49.3825,   lng:  -126.5441,  zone:  -8.0},
{name: 'East Trout Lake, Saskatchewan, Canada',                                        lat:    54.3501,   lng:  -104.9834,  zone:  -6.0},
{name: 'Eureka, Nunavut, Canada',                                                      lat:    79.9830,   lng:   -85.9500,  zone:  -4.0},
{name: 'Fairbanks, Alaska, United States',                                             lat:    64.8600,   lng:  -147.8500,  zone:  -9.0},
{name: 'Fort Peck, Montana, United States',                                            lat:    48.3078,   lng:  -105.1017,  zone:  -7.0},
{name: 'Mariana Islands, Guam',                                                        lat:    13.3860,   lng:   144.6560,  zone:  10.0},
{name: 'Gosan, Cheju Island, Republic of Korea',                                       lat:    33.2800,   lng:   126.1500,  zone:   8.0},
{name: 'Goodwin Creek, Mississippi, United States',                                    lat:    34.2547,   lng:   -89.8729,  zone:  -5.0},
{name: 'Halley Station, Antarctica, United Kingdom',                                   lat:   -75.6050,   lng:   -26.2100,  zone:  -2.0},
{name: 'Harvard Forest, Massachusetts, United States',                                 lat:    42.5378,   lng:   -72.1714,  zone:  -5.0},
{name: 'Hilo, Hawaii, United States',                                                  lat:    19.7170,   lng:  -155.0490,  zone: -10.0},
{name: 'Homer, Illinois, United States',                                               lat:    40.0700,   lng:   -87.9100,  zone:  -6.0},
{name: 'Hanford, California, United States',                                           lat:    36.3140,   lng:  -119.6320,  zone:  -8.0},
{name: 'Hohenpeissenberg, Germany',                                                    lat:    47.8011,   lng:    11.0245,  zone:   1.0},
{name: 'Houston, Texas, United States',                                                lat:    29.7200,   lng:   -95.4000,  zone:  -6.0},
{name: 'Hegyhatsal, Hungary',                                                          lat:    46.9500,   lng:    16.6500,  zone:   1.0},
{name: 'Storhofdi, Vestmannaeyjar, Iceland',                                           lat:    63.3998,   lng:   -20.2884,  zone:   0.0},
{name: 'INFLUX (Indianapolis Flux Experiment), United States',                         lat:    39.5805,   lng:   -86.4207,  zone:  -5.0},
{name: 'Izana, Tenerife, Canary Islands, Spain',                                       lat:    28.3090,   lng:   -16.4990,  zone:   0.0},
{name: 'Key Biscayne, Florida, United States',                                         lat:    25.6654,   lng:   -80.1580,  zone:  -5.0},
{name: 'Kpuszta, Keszcemet, Hungary',                                                  lat:    46.9700,   lng:    19.5500,  zone:   1.0},
{name: 'Cape Kumukahi, Hawaii, United States',                                         lat:    19.5200,   lng:  -154.8200,  zone: -10.0},
{name: 'Kwajalein, Marshall Islands',                                                  lat:     8.7150,   lng:   167.7230,  zone:   0.0},
{name: 'Lauder, New Zealand',                                                          lat:   -45.0400,   lng:   169.6800,  zone:  12.0},
{name: 'Park Falls, Wisconsin, United States',                                         lat:    45.9451,   lng:   -90.2732,  zone:  -6.0},
{name: 'Lewisburg, Pennsylvania, United States',                                       lat:    40.9447,   lng:   -76.8789,  zone:  -5.0},
{name: 'Lulin, Taiwan',                                                                lat:    23.4700,   lng:   120.8700,  zone:   8.0},
{name: 'Lampedusa, Italy',                                                             lat:    35.5200,   lng:    12.6200,  zone:   1.0},
{name: 'Mt. Bachelor Observatory, United States',                                      lat:    43.9775,   lng:  -121.6861,  zone:  -8.0},
{name: 'McMurdo Station, Antarctica, United States',                                   lat:   -77.8300,   lng:   166.6000,  zone:  12.0},
{name: 'High Altitude Global Climate Observation Center, Mexico',                      lat:    18.9841,   lng:   -97.3110,  zone:  -6.0},
{name: 'Marshall Field Site, Boulder, Colorado, United States',                        lat:    39.9491,   lng:  -105.1973,  zone:  -7.0},
{name: 'Mace Head, County Galway, Ireland',                                            lat:    53.3260,   lng:    -9.8990,  zone:   0.0},
{name: 'Sand Island, Midway, United States',                                           lat:    28.2100,   lng:  -177.3800,  zone: -11.0},
{name: 'Mauna Loa, Hawaii, United States',                                             lat:    19.5362,   lng:  -155.5763,  zone: -10.0},
{name: 'Marcapomacocha, Peru',                                                         lat:   -11.4000,   lng:   -76.3200,  zone:  -5.0},
{name: 'Marcellus Pennsylvania, United States',                                        lat:    41.4662,   lng:   -76.4188,  zone:  -5.0},
{name: 'Montsec, Spain',                                                               lat:    42.0500,   lng:     0.7300,  zone:   0.0},
{name: 'Mashpee, Massachusetts, United States',                                        lat:    41.6568,   lng:   -70.4973,  zone:  -5.0},
{name: 'Madison, Wisconsin, United States',                                            lat:    43.1300,   lng:   -89.3300,  zone:  -6.0},
{name: 'Montseny, Spain',                                                              lat:    41.7800,   lng:     2.3600,  zone:   0.0},
{name: 'Mt. Wilson Observatory, United States',                                        lat:    34.2246,   lng:  -118.0586,  zone:  -8.0},
{name: 'Farol De Mae Luiza Lighthouse, Brazil',                                        lat:    -5.7952,   lng:   -35.1853,  zone:  -3.0},
{name: 'Worcester, Massachusetts, United States',                                      lat:    42.9500,   lng:   -70.6300,  zone:  -5.0},
{name: 'Gobabeb, Namibia',                                                             lat:   -23.5800,   lng:    15.0300,  zone:   1.0},
{name: 'Niwot Ridge, Colorado, United States',                                         lat:    40.0531,   lng:  -105.5864,  zone:  -7.0},
{name: 'Haute Provence, France',                                                       lat:    43.9167,   lng:     5.7500,  zone:   1.0},
{name: 'Ochsenkopf, Germany',                                                          lat:    50.0301,   lng:    11.8084,  zone:   1.0},
{name: 'Pallas-Sammaltunturi, GAW Station, Finland',                                   lat:    67.9733,   lng:    24.1157,  zone:   2.0},
{name: 'Poker Flat, Alaska, United States',                                            lat:    65.0700,   lng:  -147.2900,  zone:  -9.0},
{name: 'Palmer Station, Antarctica, United States',                                    lat:   -64.9200,   lng:   -64.0000,  zone:  -3.0},
{name: 'Penn State, Pennsylvania, United States',                                      lat:    40.7201,   lng:   -77.9309,  zone:  -5.0},
{name: 'Perth, Australia',                                                             lat:   -31.9167,   lng:   115.9667,  zone:   8.0},
{name: 'Raleigh, North Carolina, United States',                                       lat:    35.7300,   lng:   -78.6800,  zone:  -5.0},
{name: 'Ragged Point, Barbados',                                                       lat:    13.1650,   lng:   -59.4320,  zone:  -4.0},
{name: 'Rarotonga, Cook Islands',                                                      lat:   -21.2500,   lng:  -159.8300,  zone: -10.0},
{name: 'Charleston, South Carolina, United States',                                    lat:    32.7700,   lng:   -79.5500,  zone:  -5.0},
{name: 'Beech Island, South Carolina, United States',                                  lat:    33.4057,   lng:   -81.8334,  zone:  -5.0},
{name: 'Seattle, Washington, United States',                                           lat:    47.6800,   lng:  -122.2500,  zone:  -8.0},
{name: 'Mahe Island, Seychelles',                                                      lat:    -4.6824,   lng:    55.5325,  zone:   4.0},
{name: 'Southern Great Plains, Oklahoma, United States',                               lat:    36.6070,   lng:   -97.4890,  zone:  -6.0},
{name: 'Shemya Island, Alaska, United States',                                         lat:    52.7112,   lng:   174.1260,  zone: -10.0},
{name: 'Salt Lake City, United States',                                                lat:    40.7700,   lng:  -111.9700,  zone:  -7.0},
{name: 'Tutuila, American Samoa',                                                      lat:   -14.2474,   lng:  -170.5644,  zone: -11.0},
{name: 'Hyytiala, Finland',                                                            lat:    61.8474,   lng:    24.2948,  zone:   2.0},
{name: 'Shenandoah National Park, United States',                                      lat:    38.6170,   lng:   -78.3500,  zone:  -5.0},
{name: 'Sierra Nevada, Spain',                                                         lat:    37.0960,   lng:    -3.3870,  zone:   1.0},
{name: 'Storm Peak Laboratory (Desert Research Institute), United States',             lat:    40.4500,   lng:  -106.7300,  zone:  -7.0},
{name: 'South Pole, Antarctica, United States',                                        lat:   -89.9800,   lng:   -24.8000,  zone:  12.0},
{name: 'Sutro Tower, San Francisco, California, United States',                        lat:    37.7553,   lng:  -122.4517,  zone:  -8.0},
{name: 'Summit, Greenland',                                                            lat:    72.5962,   lng:   -38.4220,  zone:  -2.0},
{name: 'Suva, Fiji',                                                                   lat:   -18.0000,   lng:   178.0000,  zone:  12.0},
{name: 'Sterling, Virginia, United States',                                            lat:    38.9800,   lng:   -77.4700,  zone:  -5.0},
{name: 'Sioux Falls, South Dakota, United States',                                     lat:    43.7340,   lng:   -96.6233,  zone:  -6.0},
{name: 'Syowa Station, Antarctica, Japan',                                             lat:   -69.0125,   lng:    39.5900,  zone:   3.0},
{name: 'Tae-ahn Peninsula, Republic of Korea',                                         lat:    36.7376,   lng:   126.1328,  zone:   9.0},
{name: 'Table Mountain, United States',                                                lat:    40.1250,   lng:  -105.2368,  zone:  -7.0},
{name: 'Sinton, Texas, United States',                                                 lat:    27.7300,   lng:   -96.8600,  zone:  -6.0},
{name: 'Trinidad Head, California, United States',                                     lat:    41.0541,   lng:  -124.1510,  zone:  -8.0},
{name: 'Hydrometeorological Observatory of Tiksi, Russia',                             lat:    71.5965,   lng:   128.8887,  zone:   9.0},
{name: 'Thurmont, Maryland, United States',                                            lat:    39.5768,   lng:   -77.4881,  zone:  -5.0},
{name: 'University of Granada, Spain',                                                 lat:    37.1640,   lng:    -3.6050,  zone:   0.0},
{name: 'Ushuaia, Argentina',                                                           lat:   -54.8484,   lng:   -68.3106,  zone:  -4.0},
{name: 'Wendover, Utah, United States',                                                lat:    39.9018,   lng:  -113.7181,  zone:  -7.0},
{name: 'Ulaan Uul, Mongolia',                                                          lat:    44.4516,   lng:   111.0956,  zone:   8.0},
{name: 'Wallops Island, Virginia, United States',                                      lat:    37.8600,   lng:   -75.5100,  zone:  -5.0},
{name: 'West Branch, Iowa, United States',                                             lat:    41.7248,   lng:   -91.3529,  zone:  -6.0},
{name: 'Walnut Grove, California, United States',                                      lat:    38.2650,   lng:  -121.4911,  zone:  -8.0},
{name: 'Whistler, Canada',                                                             lat:    50.0593,   lng:  -122.9576,  zone:  -8.0},
{name: 'Weizmann Institute of Science at the Arava Institute, Ketura, Israel',         lat:    29.9646,   lng:    35.0605,  zone:   2.0},
{name: 'Moody, Texas, United States',                                                  lat:    31.3149,   lng:   -97.3269,  zone:  -6.0},
{name: 'Mt. Waliguan, Peoples Republic of China',                                      lat:    36.2879,   lng:   100.8964,  zone:   8.0},
{name: 'Weaverville, California, United States',                                       lat:    40.7309,   lng:  -122.9419,  zone:  -8.0},
{name: 'Ny-Alesund, Svalbard, Norway and Sweden',                                      lat:    78.9067,   lng:    11.8883,  zone:   1.0},
];



var lineSunrise;
var lineSunset;
var lineAzimuth;


var redIcon = new L.icon({ iconUrl: './012.small.png', iconSize: [10, 17], iconAnchor: [4, 17] });
var yelIcon = new L.icon({ iconUrl: './036.small.png', iconSize: [10, 17], iconAnchor: [4, 17] });
var grnIcon = new L.icon({ iconUrl: './078.small.png', iconSize: [10, 17], iconAnchor: [4, 17] });
var bluIcon = new L.icon({ iconUrl: './149.small.png', iconSize: [10, 17], iconAnchor: [4, 17] });
var purIcon = new L.icon({ iconUrl: './172.small.png', iconSize: [10, 17], iconAnchor: [4, 17] });
var gryIcon = new L.icon({ iconUrl: './215.small.png', iconSize: [10, 17], iconAnchor: [4, 17] });
var whtIcon = new L.icon({ iconUrl: './216.small.png', iconSize: [10, 17], iconAnchor: [4, 17] });
var bigIcon = new L.icon({ iconUrl: './red-dot.png',   iconSize: [32, 32], iconAnchor: [16, 32] });


var cookee = GetCookie("lat")
var startLat = (cookee) ? cookee : "39.833"
cookee = GetCookie("lng")
var startLng = (cookee) ? cookee : "-98.583"
cookee = GetCookie("gmt")
var startZone = (cookee) ? cookee : "-7"


// the different map layers
mqMap = L.esri.basemapLayer('Streets');
landMap = L.esri.basemapLayer('Imagery');
topoMap = L.esri.basemapLayer('Topographic');
geoMap = L.esri.basemapLayer('NationalGeographic');

var baseLayers = {
	"Map": mqMap,
	"Satellite": landMap,
	"Topographic": topoMap,
	"Geographic": geoMap,
};

// Create the map
var map = L.map('map_canvas', {		// div id holding map
	layers: [mqMap],		// default map
	worldCopyJump: true,		// move markers if scrolling horizontally across new map
	minZoom: 1,			// minimum zoom level, skip level 0
	zoomControl: false		// don't show zoom buttons, we're using zoomslider instead
}).setView([startLat, startLng], 3);	// center map at starting position, zoom level 3

map.addControl(new L.Control.Zoomslider());

// Add the map layer switching control
L.control.layers(baseLayers).addTo(map);

// Add the city marker sets to map
var markers=[]
addMarkers(markers, "World", WorldCities, purIcon);
addMarkers(markers, "US", USCities, bluIcon);
addMarkers(markers, "Surfrad", surfrad, redIcon);
addMarkers(markers, "Site", sites, grnIcon);
addMarkers(markers, "Obs", obs, gryIcon);

// Show the correct marker set
showMarkers();


// Create Big Marker and place in center of map
var center = map.getCenter();
var bigMarker = new L.marker(center, { icon: bigIcon, draggable:true}).addTo(map);

// catch end of drag of big marker and reset map
bigMarker.on('dragend', function() {
	var point = bigMarker.getLatLng();
	// handle marker crossing dateline
	if (point.lng < -180) { point.lng += 360; } 
	if (point.lng > 180) { point.lng -= 360; }
	$('#latbox').val(point.lat);
	$('#lngbox').val(point.lng);
	latlongChanged();
});
    


/*----------------------------------------------------------------*/
// Add city markers to map
function addMarkers(list, type, markers, icon) {

	for (var i=0;i<markers.length;i++) {
		var lat = markers[i].lat;
		var lng = markers[i].lng;
		var zone = markers[i].zone;
		var tooltip = markers[i].name;
		var mrkr = new L.marker([lat,lng], { icon: icon, title: tooltip, }).addTo(map);

		mrkr.type = type;	// save the marker set name  as 'type'
		mrkr.zone = zone;	// save the time zone for this marker
		list.push(mrkr);

		mrkr.on('click', function(e) {
			var newlatlng = this.getLatLng();
			var newlat = newlatlng.lat;
			var newlng = newlatlng.lng;
			ntz = this.zone;
			$('#latbox').val(newlat);
			$('#lngbox').val(newlng);
//			if ((ntz > -13) && (ntz <= 13)) {
				$('#tz').val(ntz);
//			}

			latlongChanged();
		});
	}
}


/*----------------------------------------------------------------*/
// show the correct city marker set and hide the others
function showMarkers() {

	// Get value of marker radio button that is on
	type = $("input[name=showpins]:checked").val();

	for (var i=0;i<markers.length;i++) {

		if (markers[i].type==type)  {
			markers[i].addTo(map);
		} else {
			map.removeLayer(markers[i]);
		}
	}
}


/*----------------------------------------------------------------*/
// Called when one of the marker set radio buttons is clicked.
// Draw the new marker set and hide the others.
function refreshMap() {
	var center = map.getCenter()
	var zoom = map.getZoom()
	map.setView(center, zoom);
	showMarkers();
}

/*----------------------------------------------------------------*/
// Called when any of the form inputs change (date, location, ...)
// In this case, we want to force the correct offset into the form
// in case bad dates or times were entered into the form.
// The calculate() function validates dates and times and will reset
// them if needed, which will also reset the utc offset
/*----------------------------------------------------------------*/
function inputsChanged() {
	clearLines();
	calculate(true)
}

/*----------------------------------------------------------------*/
// Called when the utc offset input changes.
// In this case, we don't want to force the correct offset into the form,
// since the user wants to use a different offset than the default
function tzChanged() {
	clearLines();
	calculate(false)
}

/*----------------------------------------------------------------*/
// Get new location, move big marker to it, recalculate 
function latlongChanged() {

	$('#wait').css({visibility: 'visible'});

	var newlat = readTextBox("latbox", 9, 0, 0, -89.9, 89.9, 0)
	var newlng = readTextBox("lngbox", 10, 0, 0, -180.0, 180.0, 0)
console.log(newlat);
console.log(newlng);


	var newcenter = L.latLng(parseFloat(newlat), parseFloat(newlng));
//	map.setView(newcenter);
map.panTo(newcenter, {duration: 0.5});
//	bigMarker.setLatLng(newcenter);

bigMarker.slideTo(newcenter, {
	duration: 400,
	keepAtCenter: false
});

	clearLines();


	$.ajax({
		url: "gettz.php",
//		url: "gettz2.py",  // will need to upgrade python/numpy to use this
		data: { latitude: newlat, longitude: newlng }
	})
	.done(function( msg ) {
//console.log("ajax msg");
//console.log(msg);
		tzname = msg.replace("\n", "");
		if (tzname.includes("Etc")) {
			$('#tzwarn').css({visibility: 'visible'});
		} else {
                        $('#tzwarn').css({visibility: 'hidden'});
		}
		$('#tz').val(tzname);
		inputsChanged();
		$('#wait').css({visibility: 'hidden'});
	});
}

/*----------------------------------------------------------------*/
// Remove the sunrise, sunset, azimuth lines from map
function clearLines() {
	if (lineSunrise) { map.removeLayer(lineSunrise); }
	if (lineSunset) { map.removeLayer(lineSunset); }
	if (lineAzimuth) { map.removeLayer(lineAzimuth); }
}

/*----------------------------------------------------------------*/
// Draw sunrise, sunset, azimuth lines, save object
function showLineGeodesic2(type, color, direction, lat, lon) {


	if ( type == "azimuth") {
	  lineAzimuth = showLineGeodesic(color, direction, lat, lon);
	}
	if ( type == "sunrise") {
	  lineSunrise = showLineGeodesic(color, direction, lat, lon);
	}
	if ( type == "sunset") {
	  lineSunset = showLineGeodesic(color, direction, lat, lon);
	}
}


/*----------------------------------------------------------------*/
// Draw the line as geodesic line
function showLineGeodesic(color, direction, lat, lng) {
    //alert("Direction = " + direction)
    //
	var zoom  = map.getZoom()
//	var scale = (zoom > 3) ? 3/Math.pow(2,zoom) : 0.375
	var scale = 0.575
	var beginpt = L.latLng(lat, lng);
	var lat1 = degToRad(lat)
	var lng1 = degToRad(lng)
	var lat2 = Math.asin(Math.sin(lat1)*Math.cos(scale)+Math.cos(lat1)*Math.sin(scale)*Math.cos(degToRad(direction)))
	var dlon = -Math.atan2(Math.sin(degToRad(direction))*Math.sin(scale)*Math.cos(lat1), Math.cos(scale)-Math.sin(lat1)*Math.sin(lat2))
	var lon2 = ( (lng1 - dlon + Math.PI) % (2*Math.PI) ) - Math.PI
	var endpt = L.latLng(radToDeg(lat2), radToDeg(lon2));

	var line = L.geodesic(
		[[beginpt, endpt]], 
		{color: color, 
		 opacity: 0.7,
		 steps: 30,
		 weight: 5,
	}).addTo(map);

	return line;
}


